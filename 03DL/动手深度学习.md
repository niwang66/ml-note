# 预备知识
## 线性代数
### Hadamard积
对应元素乘积
### 向量-点积
对应元素乘积的和
```python 
torch.dot(x, y) == torch.sum(x * y)
```
### 矩阵-向量积torch.mv

```python
a = torch.arange(20, dtype=torch.float32).reshape(5, 4)
b = torch.arange(4, dtype=torch.float32)

tensor([[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [12., 13., 14., 15.],
        [16., 17., 18., 19.]])

tensor([ 0.,  1.,  2.,  3.])

torch.mv(a, b)
tensor([ 14.,  38.,  62.,  86., 110.])

```

### 矩阵乘法torch.mm
```python
a = torch.arange(20, dtype=torch.float32).reshape(5, 4)
b = torch.arange(20, dtype=torch.float32).reshape(4, 5)
tensor([[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [12., 13., 14., 15.],
        [16., 17., 18., 19.]])

tensor([[ 0.,  1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.,  9.],
        [10., 11., 12., 13., 14.],
        [15., 16., 17., 18., 19.]])
torch.mm(a,b)
```

### 范数torch.norm
```python
u = torch.tensor([3.0, -4.0])
torch.norm(u)

计算向量夹角
```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

cos_angle = np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
angle = np.arccos(cos_angle)

余弦相似度
import torch.nn.functional as F

vec1 = torch.FloatTensor([1, 2, 3, 4])
vec2 = torch.FloatTensor([5, 6, 7, 8])

cos_sim = F.cosine_similarity(vec1, vec2, dim=0)
```






